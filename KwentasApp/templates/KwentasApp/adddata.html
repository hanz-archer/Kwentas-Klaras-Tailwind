{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Project Data</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Base styles for the main container */
        .main-container {
            width: 100%;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        /* Form container styles */
        .form-container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Responsive grid layout */
        @media (max-width: 1024px) {
            .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            .col-span-full {
                grid-column: 1 / -1;
            }
        }

        /* Mobile optimizations */
        @media (max-width: 640px) {
            .main-container {
                padding: 0.5rem;
            }

            .form-container {
                padding: 1rem;
            }

            input, select, textarea {
                font-size: 16px !important;
            }

            .user-input-box {
                width: 100% !important;
            }
        }

        /* Dropdown positioning fixes */
        .relative ul {
            position: absolute;
            z-index: 50;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Ensure proper spacing with sidebar */
        @media (min-width: 768px) {
            .main-content {
                margin-left: 16rem;
            }
        }

        /* Prevent content overflow */
        .overflow-container {
            max-width: 100%;
            overflow-x: hidden;
        }

        /* Mobile-first responsive styles */
        @media (max-width: 640px) {
            /* Adjust input padding and font size for mobile */
            input, select, textarea {
                padding: 0.5rem !important;
                font-size: 16px !important; /* Prevents iOS zoom on focus */
            }

            /* Stack buttons vertically on mobile */
            .flex.items-center.justify-end.gap-x-6 {
                flex-direction: column;
                gap: 1rem;
            }

            /* Make buttons full width on mobile */
            .flex.items-center.justify-end.gap-x-6 button,
            .flex.items-center.justify-end.gap-x-6 a {
                width: 100%;
                text-align: center;
            }

            /* Adjust dropdown positioning for mobile */
            .relative ul {
                max-height: 50vh;
                width: 100vw;
                left: 50%;
                transform: translateX(-50%);
            }
        }

        /* Tablet styles */
        @media (min-width: 641px) and (max-width: 1024px) {
            .relative ul {
                max-height: 40vh;
            }
        }

        /* Ensure dropdowns don't get cut off */
        .relative {
            position: relative !important;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen">
        {% include 'KwentasApp/partials/aside.html' %}
        
        <!-- Main Content - Made responsive -->
        <main class="flex-1 transition-margin duration-300 ml-0 md:ml-64 min-h-screen bg-gray-100 dark:bg-gray-900">
            <div class="p-2 sm:p-4 md:p-8 w-full max-w-[100vw] overflow-hidden">
                <!-- Mobile Header with Menu Button -->
                <div class="md:hidden mb-4 flex items-center">
                    <button id="mobileSidebarToggle" class="p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                    <h1 class="ml-2 text-xl font-semibold">Add Project Data</h1>
                </div>

                <!-- Form Container -->
                <div class="bg-white rounded-lg shadow-sm p-3 sm:p-4 md:p-6 lg:p-8 w-full mx-auto">
                    <form action="{% url 'create_entry' %}" method="post" id="dataForm" class="space-y-8">
                        {% csrf_token %}
                        <div class="space-y-8">
                            <div class="border-b border-gray-900/10 pb-8">
                                <h2 class="text-base/7 font-semibold text-gray-900">Government Project Information</h2>
                                <p class="mt-1 text-sm/6 text-gray-600">Please fill in all the required details for this government project in accordance with official documentation standards.</p>

                                <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-x-4 lg:gap-x-6 gap-y-4 lg:gap-y-6 px-2 sm:px-4 md:px-8">
                                    <!-- PPA Field -->
                                    <div class="col-span-full lg:col-span-1">
                                        <label for="ppa" class="block text-sm font-medium text-gray-900 mb-1">PPA</label>
                                        <div class="mt-1">
                                            <input type="text" name="ppa" id="ppa" required
                                                class="block w-full rounded-md bg-white px-2 sm:px-3 py-1.5 text-gray-900 text-sm
                                                       outline outline-1 -outline-offset-1 outline-gray-300 
                                                       focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600">
                                        </div>
                                    </div>

                                    <!-- Two columns layout for form fields -->
                                    <div class="col-span-full grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <!-- First column -->
                                        <div class="space-y-6">
                                            <!-- Implementing Unit Dropdown -->
                                            <div class="sm:col-span-3">
                                                <label for="departmentInput" class="block text-sm/6 font-medium text-gray-900">Implementing Unit</label>
                                                <div class="mt-2 relative">
                                                    <input type="text" id="departmentInput" name="implementing_unit" readonly required
                                                        onclick="toggleDepartmentDropdown()"
                                                        placeholder="Select Department"
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6 cursor-pointer">
                                                    <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-500" viewBox="0 0 16 16" fill="currentColor">
                                                        <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z"/>
                                                    </svg>
                                                    <ul id="departmentOptions" class="hidden absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 max-h-60 overflow-auto">
                                                        <li onclick="selectDepartmentOption('Mayors Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Mayor's Office</li>
                                                        <li onclick="selectDepartmentOption('Tourism Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Tourism Office</li>
                                                        <li onclick="selectDepartmentOption('BAC Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">BAC Office</li>
                                                        <li onclick="selectDepartmentOption('Accountant Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Accountant Office</li>
                                                        <li onclick="selectDepartmentOption('Engineering Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Engineering Office</li>
                                                        <li onclick="selectDepartmentOption('PESO Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">PESO Office</li>
                                                        <li onclick="selectDepartmentOption('MDRRMO')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MDRRMO</li>
                                                        <li onclick="selectDepartmentOption('Sanguniang Baranggay Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Sanguniang Barangay Office</li>
                                                        <li onclick="selectDepartmentOption('MPDC Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MPDC</li>
                                                        <li onclick="selectDepartmentOption('MCR Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MCR Office</li>
                                                        <li onclick="selectDepartmentOption('MBO Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MBO Office</li>
                                                        <li onclick="selectDepartmentOption('Assessor Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Assessor's Office</li>
                                                        <li onclick="selectDepartmentOption('MHO Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MHO Office</li>
                                                        <li onclick="selectDepartmentOption('Parks & Plaza')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Parks & Plaza</li>
                                                        <li onclick="selectDepartmentOption('MSWD Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MSWD Office</li>
                                                        <li onclick="selectDepartmentOption('MENRO Office')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MENRO Office</li>
                                                        <li onclick="selectDepartmentOption('MO')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">MO</li>
                                                        <li onclick="selectDepartmentOption('Streets & Bridges')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Streets & Bridges</li>
                                                        <li onclick="selectDepartmentOption('LDF')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">LDF</li>
                                                        <li onclick="selectDepartmentOption('Waterworks')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Waterworks</li>
                                                        <li onclick="selectDepartmentOption('Markets')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Markets</li>
                                                        <li onclick="selectDepartmentOption('Zero Waste')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Zero Waste</li>
                                                    </ul>
                                                </div>
                                            </div>

                                            <!-- Location Dropdown -->
                                            <div class="sm:col-span-3">
                                                <label for="locationInput" class="block text-sm/6 font-medium text-gray-900">Location</label>
                                                <div class="mt-2 relative">
                                                    <input type="text" id="locationInput" name="location" readonly required
                                                        onclick="toggleLocationDropdown()"
                                                        placeholder="Select Location"
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6 cursor-pointer">
                                                    <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-500" viewBox="0 0 16 16" fill="currentColor">
                                                        <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z"/>
                                                    </svg>
                                                    <ul id="locationOptions" class="hidden absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 max-h-60 overflow-auto">
                                                        <li onclick="selectLocationOption('Baranggay Baclayan')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Baclayan</li>
                                                        <li onclick="selectLocationOption('Baranggay El Pardo')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay El Pardo</li>
                                                        <li onclick="selectLocationOption('Baranggay Granada')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Granada</li>
                                                        <li onclick="selectLocationOption('Baranggay Lower Becerril')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Lower Becerril</li>
                                                        <li onclick="selectLocationOption('Baranggay Poblacion')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Poblacion</li>
                                                        <li onclick="selectLocationOption('Baranggay San Antonio')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay San Antonio</li>
                                                        <li onclick="selectLocationOption('Baranggay Upper Becerril')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Upper Becerril</li>
                                                        <li onclick="selectLocationOption('Baranggay Arbor')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Arbor</li>
                                                        <li onclick="selectLocationOption('Baranggay Lunop')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Lunop</li>
                                                        <li onclick="selectLocationOption('Baranggay Nangka')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay Nangka</li>
                                                        <li onclick="selectLocationOption('Baranggay South Granada')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Baranggay South Granada</li>
                                                    </ul>
                                                </div>
                                            </div>

                                            <!-- Appropriation Field -->
                                            <div class="sm:col-span-3">
                                                <label for="appropriation-input" class="block text-sm/6 font-medium text-gray-900">Appropriation</label>
                                                <div class="mt-2 relative">
                                                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500">₱</span>
                                                    <input type="text" id="appropriation-input" name="appropriation" required
                                                        class="block w-full rounded-md bg-white pl-7 pr-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                                                </div>
                                            </div>

                                            <!-- Start Date Field -->
                                            <div class="sm:col-span-3">
                                                <label for="start_date" class="block text-sm/6 font-medium text-gray-900">Start Date</label>
                                                <div class="mt-2">
                                                    <input type="date" id="start_date" name="start_date" required
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                                                </div>
                                            </div>

                                            <!-- End Date Field -->
                                            <div class="sm:col-span-3">
                                                <label for="end_date" class="block text-sm/6 font-medium text-gray-900">End Date</label>
                                                <div class="mt-2">
                                                    <input type="date" id="end_date" name="end_date" required
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Second column -->
                                        <div class="space-y-6">
                                            <!-- Services Dropdown -->
                                            <div class="sm:col-span-3">
                                                <label for="servicesInput" class="block text-sm/6 font-medium text-gray-900">Services</label>
                                                <div class="mt-2 relative">
                                                    <input type="text" id="servicesInput" name="services" readonly required
                                                        onclick="toggleServicesDropdown()"
                                                        placeholder="Select Service"
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6 cursor-pointer">
                                                    <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-500" viewBox="0 0 16 16" fill="currentColor">
                                                        <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z"/>
                                                    </svg>
                                                    <ul id="servicesOptions" class="hidden absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5">
                                                        <li onclick="selectServicesOption('General')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">General</li>
                                                        <li onclick="selectServicesOption('Social')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Social</li>
                                                        <li onclick="selectServicesOption('Economic')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Economic</li>
                                                        <li onclick="selectServicesOption('Environmental')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Environmental</li>
                                                    </ul>
                                                </div>
                                            </div>

                                                                                        <!-- Code Field -->
                                            <div class="sm:col-span-3">
                                                <label for="code" class="block text-sm/6 font-medium text-gray-900">Code</label>
                                                <div class="mt-2">
                                                    <input type="text" id="code" name="code" required
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                                                </div>
                                            </div>

                                                                                        <!-- Remarks Dropdown -->
                                            <div class="sm:col-span-3">
                                                <label for="remarksInput" class="block text-sm/6 font-medium text-gray-900">Remarks</label>
                                                <div class="mt-2 relative">
                                                    <input type="text" id="remarksInput" name="remarks" readonly required
                                                        onclick="toggleRemarksDropdown()"
                                                        placeholder="Select Remarks"
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6 cursor-pointer">
                                                    <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-500" viewBox="0 0 16 16" fill="currentColor">
                                                        <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z"/>
                                                    </svg>
                                                    <ul id="remarksOptions" class="hidden absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5">
                                                        <li onclick="selectRemarksOption('No PPMP/APP/POW')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">No PPMP/APP/POW</li>
                                                        <li onclick="selectRemarksOption('Awarded Already')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Awarded Already</li>
                                                        <li onclick="selectRemarksOption('Finished Already')" class="px-4 py-2 hover:bg-gray-100 cursor-pointer">Finished Already</li>
                                                    </ul>
                                                </div>
                                            </div>

                                            <!-- Year Field -->
                                            <div class="sm:col-span-3">
                                                <label for="year" class="block text-sm/6 font-medium text-gray-900">Year</label>
                                                <div class="mt-2">
                                                    <input type="number" id="year" name="year" required
                                                        class="block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex items-center justify-end gap-x-6 pr-8">
                        <a href="{% url 'homepage' %}" id="cancelButton" 
                           class="rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
                            Cancel
                        </a>
                        <button type="submit" 
                                class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- Add this script section before closing body tag -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mainContent = document.querySelector('main');
            const sidebar = document.querySelector('aside');
            const mobileMenuButton = document.getElementById('mobileSidebarToggle');

            function adjustLayout() {
                if (window.innerWidth < 768) {
                    mainContent.style.marginLeft = '0';
                } else {
                    mainContent.style.marginLeft = sidebar.classList.contains('hidden') ? '0' : '16rem';
                }
            }

            // Handle mobile menu toggle
            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', function() {
                    sidebar.classList.toggle('hidden');
                    adjustLayout();
                });
            }

            // Handle window resize
            window.addEventListener('resize', adjustLayout);

            // Initial layout adjustment
            adjustLayout();

            // Close dropdowns when clicking outside
            document.addEventListener('click', function(event) {
                const dropdowns = document.querySelectorAll('.relative ul');
                dropdowns.forEach(dropdown => {
                    if (!event.target.closest('.relative')) {
                        dropdown.classList.add('hidden');
                    }
                });
            });

            // Prevent zoom on iOS devices
            const metas = document.getElementsByTagName('meta');
            let hasViewport = false;
            
            for (let i = 0; i < metas.length; i++) {
                if (metas[i].name === 'viewport') {
                    hasViewport = true;
                    metas[i].content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0';
                }
            }

            if (!hasViewport) {
                const meta = document.createElement('meta');
                meta.name = 'viewport';
                meta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0';
                document.head.appendChild(meta);
            }
        });

        // Dropdown toggle functions
        function toggleDepartmentDropdown() {
            const options = document.getElementById('departmentOptions');
            const arrow = document.getElementById('departmentDropdownArrow');
            options.classList.toggle('hidden');
            if (arrow) {
                arrow.classList.toggle('rotate-180');
            }
        }

        function toggleLocationDropdown() {
            const options = document.getElementById('locationOptions');
            const arrow = document.getElementById('locationDropdownArrow');
            options.classList.toggle('hidden');
            if (arrow) {
                arrow.classList.toggle('rotate-180');
            }
        }

        function toggleServicesDropdown() {
            const options = document.getElementById('servicesOptions');
            const arrow = document.getElementById('servicesDropdownArrow');
            options.classList.toggle('hidden');
            if (arrow) {
                arrow.classList.toggle('rotate-180');
            }
        }

        function toggleRemarksDropdown() {
            const options = document.getElementById('remarksOptions');
            options.classList.toggle('hidden');
        }

        // Selection functions
        function selectDepartmentOption(value) {
            document.getElementById('departmentInput').value = value;
            toggleDepartmentDropdown();
        }

        function selectLocationOption(value) {
            document.getElementById('locationInput').value = value;
            toggleLocationDropdown();
        }

        function selectServicesOption(value) {
            document.getElementById('servicesInput').value = value;
            toggleServicesDropdown();
        }

        function selectRemarksOption(value) {
            document.getElementById('remarksInput').value = value;
            toggleRemarksDropdown();
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const departmentDropdown = document.getElementById('departmentOptions');
            const locationDropdown = document.getElementById('locationOptions');
            const servicesDropdown = document.getElementById('servicesOptions');
            const remarksDropdown = document.getElementById('remarksOptions');

            // Department dropdown
            if (!event.target.matches('#departmentInput') && !event.target.closest('#departmentOptions')) {
                departmentDropdown.classList.add('hidden');
                const deptArrow = document.getElementById('departmentDropdownArrow');
                if (deptArrow && deptArrow.classList.contains('rotate-180')) {
                    deptArrow.classList.remove('rotate-180');
                }
            }

            // Location dropdown
            if (!event.target.matches('#locationInput') && !event.target.closest('#locationOptions')) {
                locationDropdown.classList.add('hidden');
                const locArrow = document.getElementById('locationDropdownArrow');
                if (locArrow && locArrow.classList.contains('rotate-180')) {
                    locArrow.classList.remove('rotate-180');
                }
            }

            // Services dropdown
            if (!event.target.matches('#servicesInput') && !event.target.closest('#servicesOptions')) {
                servicesDropdown.classList.add('hidden');
                const servArrow = document.getElementById('servicesDropdownArrow');
                if (servArrow && servArrow.classList.contains('rotate-180')) {
                    servArrow.classList.remove('rotate-180');
                }
            }

            // Remarks dropdown
            if (!event.target.matches('#remarksInput') && !event.target.closest('#remarksOptions')) {
                remarksDropdown.classList.add('hidden');
            }
        });

        // Form submission handling with SweetAlert2
        document.getElementById('dataForm').addEventListener('submit', function(event) {
            event.preventDefault();

            // Collecting form data
            const formData = {
                ppa: document.querySelector('input[name="ppa"]').value,
                implementing_unit: document.getElementById('departmentInput').value,
                location: document.getElementById('locationInput').value,
                appropriation: document.querySelector('input[name="appropriation"]').value,
                start_date: document.querySelector('input[name="start_date"]').value,
                end_date: document.querySelector('input[name="end_date"]').value,
                remarks: document.getElementById('remarksInput').value,
                code: document.querySelector('input[name="code"]').value,
                services: document.getElementById('servicesInput').value,
                year: document.querySelector('input[name="year"]').value
            };
            // SweetAlert2 confirmation
            Swal.fire({
                title: 'Confirm Submission',
                text: 'Are you sure you want to submit this form?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Yes, submit it!',
                cancelButtonText: 'No, cancel',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    // If confirmed, submit the form
                    this.submit();
                }
            });
        });

        // Input masking for appropriation field
        document.getElementById('appropriation-input').addEventListener('input', function(e) {
            // Remove any non-numeric characters except commas
            let value = e.target.value.replace(/[^0-9]/g, '');
            
            // Format the number with commas
            value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            
            // Set the formatted value back to the input field
            e.target.value = value;
        });
    </script>
</body>
</html>

